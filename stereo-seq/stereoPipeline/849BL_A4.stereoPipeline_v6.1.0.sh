#!/bin/bash
#SBATCH --partition=standard
#SBATCH --account=mliang1
#SBATCH --job-name=849BL_A4.stereoPipeline
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=48
#SBATCH --mem-per-cpu=4gb
#SBATCH --time=24:00:00
#SBATCH --output=/xdisk/mliang1/qqiu/data/multiomics-hypertension/stereo_seq/_log/849BL_A4.stereoPipeline\-%j.out
#SBATCH --mail-type=ALL
#SBATCH --mail-user=qqiu@arizona.edu

# module load singularity
module load python
# module load hdf5/openmpi/gcc/64

dataDir=/xdisk/mliang1/qqiu/data/multiomics-hypertension/849BL_A4/00.Rawdata

sh /xdisk/mliang1/qqiu/software/stereoPipeline_v6.1.mod.sh  \
    -genomeSize 2.5 \
    -splitCount 16 \
    -maskFile /xdisk/mliang1/qqiu/data/multiomics-hypertension/849BL_A4/SS200000849BL_A4.barcodeToPos.h5 \
    -fq1 $dataDir/barcode_86/FP200008305_L01_86_9.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_1.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_1.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_14.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_16.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_2.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_10.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_7.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_11.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_3.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_3.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_16.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_16.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_5.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_8.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_10.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_3.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_5.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_4.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_12.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_11.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_2.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_4.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_5.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_15.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_7.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_15.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_15.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_13.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_12.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_4.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_9.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_1.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_13.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_14.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_11.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_6.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_8.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_6.fq.gz,$dataDir/barcode_86/FP200008305_L01_86_13.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_2.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_7.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_14.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_6.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_9.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_10.fq.gz,$dataDir/barcode_86/FP200007425_L01_86_12.fq.gz,$dataDir/barcode_86/FP200007272_L01_86_8.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_14.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_1.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_6.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_8.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_10.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_13.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_3.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_5.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_2.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_14.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_9.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_8.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_15.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_10.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_13.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_5.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_5.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_3.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_16.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_4.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_9.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_7.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_7.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_4.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_12.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_11.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_11.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_9.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_4.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_12.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_16.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_10.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_1.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_1.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_13.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_7.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_6.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_2.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_14.fq.gz,$dataDir/barcode_83/FP200007272_L01_83_16.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_6.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_2.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_8.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_3.fq.gz,$dataDir/barcode_83/FP200007425_L01_83_15.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_12.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_11.fq.gz,$dataDir/barcode_83/FP200008305_L01_83_15.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_7.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_10.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_13.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_5.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_1.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_7.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_13.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_1.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_11.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_14.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_15.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_16.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_16.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_2.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_1.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_8.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_8.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_14.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_10.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_15.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_12.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_9.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_7.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_2.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_6.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_3.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_4.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_16.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_4.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_11.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_5.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_2.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_3.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_8.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_6.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_11.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_5.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_13.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_9.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_4.fq.gz,$dataDir/barcode_84/FP200007272_L01_84_10.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_15.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_12.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_14.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_12.fq.gz,$dataDir/barcode_84/FP200008305_L01_84_6.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_3.fq.gz,$dataDir/barcode_84/FP200007425_L01_84_9.fq.gz \
    -refIndex /xdisk/mliang1/qqiu/reference/SAW/mm10/STAR_SJ100/ \
    -speciesName mouse \
    -tissueType left ventricle \
    -imageRecordFile /xdisk/mliang1/qqiu/data/multiomics-hypertension/849BL_A4/SS200000849BL_A4_SC_20230118_115502_1.1.4.ipr \
    -imageCompressedFile /xdisk/mliang1/qqiu/data/multiomics-hypertension/849BL_A4/SS200000849BL_A4_SC_20230118_115502_1.1.4.tar.gz \
    -annotationFile /xdisk/mliang1/qqiu/reference/SAW/mm10/genes/genes.gtf \
    -outDir /xdisk/mliang1/qqiu/project/multiomics-hypertension/stereo_seq/result/849BL_A4 \
    -sif /xdisk/mliang1/qqiu/software/SAW_6.1.sif \
    -doCellBin Y \
    -threads 16
